# **ch.3 서브도메인과 전략적 설계**

DDD 프로젝트를 진행할 때, 항상 그 안에는 다수의 **바운디드 컨텍스트**가 존재한다.

- 하나는 **핵심도메인**이 될 것이며, 다른 **바운디드 컨텍스트**에는 다양한 **서브 도메인**이 존재할 것이다.
- 특정 **보편언어**로 모델을 서로 다르게  나누고 여러 개의 **바운디드 컨텍스트**로 구성하는 것이 중요하단 사실을 잊지말자.
- 애자일 프로젝트 관리 핵심은 하나의 **바운디드 컨텍스트**와 하나의 **서브도메인** 모두를 포함한다는 것이다.
- 하나의 **바운디드 컨텍스트** 안에 다수의 **서브도메인이** 있을 수도 있는데, 이 경우는 최적의 모델을 구성했다고 보기 힘들다.

<br>

> ### **서브도메인**

간단히, **서브도메인**은 전체 비즈니스 도메인의 하위 부분을 말한다.

- 거대하고 복잡한 프로젝트에서 문제 영역을 이해할 수 있도록 전체 비즈니스 도메인을 논리적으로 쪼개는데 **서브도메인**이 사용할 수 있다.
- **서브도메인**은 크든, 작든 비즈니스에 대한 전략적 의의가 있다.
- **서브 도메인**을 개발하는데 DDD를 사용했다면 명확한 **바운디드 컨텍스트**를 구현할 수 있다.

<br>

**서브도메인**의 유형은 주요 세가지를 이야기 할 수 있다.

> **핵심 도메인**

**보편언어**를 신중하게 만들기위한 전략적 투자 영역으로, 주요 자원을 할당하는 명시적인 **바운디드 컨텍스트**이며, 잘 정의된 도메인 모델이 존재한다. DDD 를 사용하고 있는 프로젝트에 대해 논의한다면, **핵심도메인**에 대한 논의는 반드시 필요하다.

- **핵심 도메인**은 다른 경쟁자들에 대한 차별화를 만들 영역이기 때문에 기업의 프로젝트 목록에서 높은 우선순위를 갖는다.
- **핵심 도메인**은 기업이 뛰어나야 하는 부분에 대한 경계를 구분해준다.
- 당연하게도 **핵심 도메인**은 소프트웨어에서 가장 큰 투자가 필요한 곳이다.

<br>

> **지원 서브 도메인**

이미 존재하는 제품으로 해결할 수 없는 맞춤 제작 개발이 필요한 모델링 영역을 말한다.

- **지원 서브 도메인**은 핵심 도메인에서와 같은 투자 방식을 동일하게 따를 필요는 없다.
- **지원 서보 도메인** 없이 핵심 도메인을 성공시킬 수는 없기때문에 **지원 서브 도메인**은 중요한 소프트웨어 모델이다.

<br>

> **일반 서브 도메인**

기존 제품 구매를 통해 바로 충족 시킬 수 있는 경우에 해당한다.

- **일반 서브 도메인**을 **핵심 도메인**으로 오해하지 않도록 주의하자.

<br>

> ### **복잡성 다루기**

**비즈니스 도메인** 안의 시스템 경계 중 일부는 레거시 시스템일 가능성이 높은데, 그 시스템들이 **핵심 도메인** 프로젝트에 어떤 영향을 주고 있는지는 명확해야한다.

- **문제 영역**에 대해 논의하기 위한 도구로 **서브도메인**을 사용하도록 하자.
- 실제 상황에서의 일부 레거시 시스템들은 **바운디드 컨텍스트**를 기반으로 설계하는 DDD의 방향과는 상층되는 경우가 많다. 그리고 이런 것을 제한된 경계가 없는 (unbounded) 레거시 시스템으로 여기며, **큰 진흙 덩어리** 이다.

- **큰 진흙 덩어리**는 분리해서 설계와 구현했었어야만 하는, 무질서하고 복잡해서 엉망진창인 여러 개의 뒤엉킨 모델들이 현실에는 한 시스템 안에 가득 들어있는 것을 말한다.

<br>

레거시 시스템을 논할 때, 몇개(혹은 그 이상) 논리적(Logical) **도메인 모델**이 존재한다면, 이것을 **서브도메인**으로 생각할 수 도있다.

- 문제 영역을 DDD와 여러 개의 **바운디드 컨텍스트**를 사용하여 개발한 시스템처럼 다룰 수 있다.
- 구분된 **보편언어**는 최소한 레거시 시스템들을 어떻게 통합해야 할지 이해하는데 도움이 된다.
- **서브 도메인**을 활용하여 레거시 시스템을 바라보고 논의 해봄으로써 거대한 모델이라는 어려운 현실을 극복할 수 있다.

<br>

**서브 도메인**을 활용하여 작업 중이거나 관련 있는 핵심 도메인을 하나의 간단한 다이어그램 안에 표현 해볼 수 있다.

![relationOfDomain](/img/relationOfDomain.png)

- **바운디드 컨텍스트**와 **서브도메인**은 일대일(1:1) 관계를 맺어야한다. 하나의 **바운디드 컨텍스트** 안에 오직 1개의 **서브도메인** 모델을 두는 것을 목표로한다.
- 이는 바운디드 컨텍스트를 정확하게 유지시키고 핵심 전략 목표에 집중하는데 도움을 준다.

<br>

만약, **핵심 도메인** 안에 존재하는 동일한 **바운디드 컨텍스트** 안에 다른 모델을 만들어야 한다면, **핵심 도메인**으로부터 완전히 분리된 모듈(IDDD) 형태로 그 모델을 별도의 영역에 정의해야한다.

- 이것은 하나의 모델이 핵심을 이루고 다른 모델들은 지원하는 역할이라는 구성을 명확하게 나타낼 수 있다.
- **서브도메인**을 구분하는 일은 해결 영역에 계속 적용된다.
