# 코드의 디커플링

소프트웨어 설계와 개발 과정에서 코드의 `복잡성`은 `가독성`과 `유지보수성` 과 연관이 있기 때문에 우리는 코드의 `복잡성`을 제어해야한다.

그리고 코드의 복잡성을 제어하는 가장 효과적인 방법은 `디커플링`이다.

- `디커플링`을 통해 `응집도`가 높고 `결합도`가 낮은 코드를 만들 수 있다.

<br>

> 높은 응집도와 낮은 결합도

높은 `응집도`와 낮은 `결합도`는 클래스 간의 세분화된 관계 설계를 이끌어 낼 뿐만아니라 세분화된 시스템, 아키텍처, 모듈의 설계를 이끌어내는 일반적인 사상이다.

- 코딩 규칙에 비하여 더 높은 수준에서 코드의 `가독성`과 `유지보수성`을 향상 시킬 수 있다.
- 높은 `응집도` 와 낮은 `결합도` 의 특성을 활용한다면, 다른 모듈이나 클래스 코드에 대해 너무 많이 이해할 필요 없이 모듈이나 클래스에 집중할 수 있다.
- `의존성` 이 간단하고 `결합도` 가 낮아 코드 수정이 전체적인 코드에 영향을 미치지 않으며, 버그의 발생 가능성을 줄여준다.
	- 코드의 전체 구조를 조정하는 작업 없이도 특정 모듈이나 클래스에 집중하는 소규모 리팩터링이 가능하며, 리팩터링 난이도가 대폭 하락할 수 있다.
- 높은 `응집도` 와 낮은 `결합도` 를 가진 코드는 그 구조가 명확하고 `계층화` 와 `모듈화` 가 합리적이며 `의존성`이 간단하고 모듈이나 클래스 사이의 `결합도`가 낮다는 것을 의미한다.

	<br><hr>

## 언제 코드를 디커플링 해야하는가?

그렇다면 언제 코드를 `디커플링` 해야할까? 그 기준은 다양하겠지만, 다음과 같은 상황에서는 `디커플링` 을 우선적으로 고려해보는 것이 좋다.

- 기능의 코드의 일부가 수정되면 전체 코드를 모두 건드려야 하는 상황이 발생할 경우(프로젝트 코드 결합도가 너무 높아 디커플링이 필요하다.)
- 모듈과 클래스 사이의 의존 관계가 복잡하고 혼잡한 경우(코드 구조의 문제)

<br><hr>

## 코드를 디커플링 하는 방법

### 1. 캡슐화와 추상화를 활용한다.

`캡슐화` 와 `추상화` 는 `시스템`, `모듈`, `클래스 라이브러리`, `구성 요소`, `인터페이스`,` 클래스 설계` 와 같은 다양한 코드 설계 시나리오에 적용이 가능하다.

- `캡슐화` 와 `추상화` 는 구현의 `복잡성` 을 효과적으로 숨길 수 있다.
- 구현의 변동성을 격리하며, `상위 모듈`(호출자)에게 안정적이고 사용하기 쉬운 `인터페이스`를 제공할 수 있다.

<br>

### 2. 중간 계층을 사용한다.

<img width="642" alt="중간계층 사용" src="https://github.com/KEEMSY/STUDY/assets/96563125/a5ae8254-5592-47e2-a062-671a28727a5b">

<br>

`중간계층`은 모듈 사이 또는 클래스 사이의 `의존성`을 단순화 할 수 있다.

- `중간계층`의 도입은 모듈간의 의존성을 단순화하고 코드 구조를 더 명확하게 만들 수 있다.
- `리팩터링`을 진행할 때도 `중간계층`이 과도기적 역할을 할 수있어 개발 프로세스와 `리팩터링` 프로세스가 서로 간섭하지 않고 동시에 진행 될 수 있다.
	- 단계적으로 리팩터링이 가능하다.
	- 리팩터링 프로세스와 개발 프로세스가 서로 충돌할 가능성이 낮아진다.

<br>

### 3. 모듈화와 계층화를 적용한다.

복잡한 시스템을 개발하고 유지할 수 있는 주된 이유는 전체 시스템을 `프로세스 스케줄링`, `프로세스 통신`, `메모리 관리`, `가상 파일 시스템`, `네트워크 인터페이스 모듈` 등 여러 개의 독립적인 `모듈`로 분할하기 때문이다.

- `모듈화`는 복잡한 시스템을 구축할 때 사용되는 일반적인 수단이다.
- `모듈`은 `인터페이스`를 통해 통신하며 `모듈` 간의 `결합도`는 매우 낮다.
	- `모듈`은 독립적인 `클래스 라이브러리`로 개발해야 한다.
	- `모듈`은 다른 모듈이 클래스의 내부에 접근할 수 있도록 구현 세부사항을 `캡슐화` 하여, `인터페이스` 형식으로 제공해야 한다.
- `모듈화`의 개념은 `서비스 기반의 아키텍처(SOA)`, `마이크로 서비스(MSA)`, `클래스 라이브러리`, `클래스`와 기능의 설계에 반영된다.

<br>

> **모듈화의 본질은 분할을 통한 제어** 이다.


<br>

`모듈화` 외에도 `계층화`는 복잡한 시스템을 구축하는 일반적인 수단이며, 복잡한 시스템이 발전할수록 계층화 기술을 최대한 이용해야 한다.

- 각 계층은 구현 세부 사항을 `캡슐화`하고 상위 계층에서 사용할 `추상 인터페이스`를 노출한다.
- 다른 계층의 코드에 영향을 주지 않고 각 계층을 다시 구현하거나 업데이트 할 수 있다.
- `재사용`이 용이하고 특정 비즈니스와 관계 없는 코드는 최대한 하위계층으로 내리고, 수정이 빈번한 특정 비즈니스와 깊게 관련된 코드는 상위 계층으로 올려야한다.
